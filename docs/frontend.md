# Frontend (Next.js)

## Структура проекта

```
frontend/
├── app/
│   ├── (auth)/
│   │   ├── login
│   │   └── verify-email
│   ├── dashboard/
│   │   ├── page.tsx
│   │   ├── balance/
│   │   ├── games/
│   │   ├── reports/
│   │   └── settings/
│   ├── admin/
│   └── layout.tsx
├── components/
│   ├── ui/ (shadcn/ui)
│   ├── charts/
│   ├── forms/
│   └── widgets/
├── lib/
│   ├── api-client.ts
│   ├── auth.ts
│   ├── websocket.ts
│   └── report-builder.ts
├── hooks/
├── store/ (React Query configs)
└── styles/
```

## Основные сценарии

### Регистрация/Авторизация
- Telegram Login Widget инициирует OAuth поток.
- После успешной авторизации пользователь попадает на экран подтверждения email.
- Email 2FA подтверждается через код, отправленный по почте.

### Личный кабинет
- Дашборд показывает карточки балансов (реальный/бонусный/заблокированный).
- История операций использует виртуализированную таблицу с React Query и пагинацией.
- Избранные игры отображаются в карусели с быстрым доступом к запуску.
- Раздел Responsible Gaming позволяет выставлять дневные/недельные лимиты.

### Игры
- Каталог игр с фильтрами по провайдерам, жанрам, волатильности.
- Запуск игры открывает `iframe` или WebView с SSO-ссылкой, полученной от GameService.
- В реальном времени обновляются балансы через WebSocket.

### Платежи
- Формы депозитов и выводов используют компоненты валидации shadcn/ui и Zod.
- После отправки формы запускается мутация React Query с показом состояния.

### Конструктор отчётов
- Доступен через маршрут `/dashboard/reports`.
- Пользователь выбирает параметры: диапазон дат, типы транзакций, валюту, провайдера.
- Результаты отображаются в таблице и графиках (Recharts/Victory).
- Возможен экспорт в CSV/Excel/JSON.

## Взаимодействие с API

- React Query для запросов к GraphQL/REST с автоматическим обновлением кэша.
- WebSocket соединение для событий баланса и игр (channel `user:{id}`).
- Механизм retry и exponential backoff для неудачных запросов.

## Безопасность

- Хранение токенов в `httpOnly` cookies.
- Проверка CSRF через double submit token.
- Локализация интерфейса (i18n) и поддержка нескольких валют/таймзон.

## Тестирование

- Jest/React Testing Library для unit и интеграционных тестов.
- Playwright/Cypress для e2e сценариев (регистрация, депозит, запуск игры).
- Storybook для визуального тестирования компонентов.

